import rsa_helper_functions as rsa

# works except for large values of msg

p = rsa.genprime(1024)
q = rsa.genprime(1024)
keys = rsa.keysgen(p,q)
print(keys)
priv = keys['priv']
pub = keys['pub']

msg = 11171050520438411054934736817447534738881853790600371514912850782130351377573412033550782314472884009700237566774850568984618065055790366791530733510628583973827552191306197335360160780963715334882077828375289388653911196911039123802554068463058023131948477522943985173872542921150570322734951509078442414026763328477091780141092527970621491958804624539404969476244720722392570446967947403485970393760352799268540299912480308894990478277205482964863115581021526324035828384306959113798495777124704612499990874351562486454668535677148000941933340445875644868092815912884824128035327899527111341502821750339965954532469
msg_bytes = msg.to_bytes(2048, 'big')
enc = rsa.encrypt_bytes(msg_bytes, pub)
dec = rsa.decrypt_bytes(enc, priv)
test=0
print(test.from_bytes(dec,'big'))
